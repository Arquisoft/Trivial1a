@()

@import helper._

@main("Juego",scripts) {
<link rel="stylesheet" type="text/css" href=@routes.Assets.at("stylesheets/index.scala.css") media="screen" />	
<div id="container" > 



<div id="myModal" class="modal fade"  data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog" >
        <div class="modal-content">
            <div class="modal-header">
                 <h4 class="modal-title" id="pr">Pregunta</h4>
            </div>
            <div class="modal-body"> 
                    <div class="panel panel-default">
                        <div class="panel-body">
                            <div class="table-responsive">
                            <input id="res" type="hidden" name="respuesta">
                                <table class="table"> 
                                    <tbody>
                                        <tr>
                                            <td>1</td>
                                            <td ><input id="res1" name="res1" class="btn btn-sm btn-success btn-block" type="button" onclick="compareAnswer(this)"  ></td>
                                        </tr> 
                                        <tr>
                                            <td>2</td>
                                            <td ><input id="res2" name="res2" class="btn btn-sm btn-success btn-block" type="button" onclick="compareAnswer(this)" ></td>
                                        </tr> <tr>
                                            <td>3</td>
                                            <td ><input id="res3" name="res3" class="btn btn-sm btn-success btn-block" type="button" onclick="compareAnswer(this)" ></td>
                                        </tr><tr>
                                            <td>4</td>
                                            <td ><input id="res4" name="res4" class="btn btn-sm btn-success btn-block" type="button" onclick="compareAnswer(this)" ></td>
                                        </tr>  
                                    </tbody>
                                </table> 
                            <!-- /.table-responsive -->
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                </div>  
                <div class="modal-footer">
                <div class="alert alert-danger collapse" id="error" >
    		<strong>¡Error!</strong> has fallado
 				 </div>
 				 <div class="alert alert-success collapse" id="acierto" >
    		<strong>¡Bien hecho!</strong> Has acertado.
  					</div>
                <button id="ok" type="button" class="btn btn-primary collapse" data-dismiss="modal">Ok</button> 
            </div>
            
            
            </div> 
        </div>
    </div>
</div>



	<canvas id="lienzo" width="500" height="500">Su navegador no soporta canvas :( </canvas>
</div> 
<h2>Trivial 1a</h2>  
}


 @scripts= {
 
 		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
 		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
 

  		<script type="text/javascript">
  		
  		function compareAnswer(elmnt){
  		var correcta;
  		var respuesta;
  		respuesta=elmnt.value;
  		correcta=document.getElementById("res").value;
  		
  		
  		$("#res1").prop('disabled', true); 
  		$("#res2").prop('disabled', true);
  		$("#res3").prop('disabled', true);
  		$("#res4").prop('disabled', true);
  		
  		if(correcta === respuesta){ 
  		  	 $("#ok").show();
  			$("#acierto").show();
  			
  		}else
  		{  
  		  	 $("#ok").show(); 
  			$("#error").show();
  		
  		}
  		
  		}
  		
  		window.onload = function() {
										var canvas = document.getElementById("lienzo");
												if (canvas && canvas.getContext) {
												
												var ctx = canvas.getContext("2d");
						
												if (ctx) {			
														
										
													var output = document.getElementById("output");								
										
													canvas.addEventListener("mousemove", function(evt) {
														var mousePos = oMousePos(canvas, evt);
													marcarCoords(output, mousePos.x, mousePos.y)
													}, false);
																						
													canvas.addEventListener("mouseout", function(evt) {
													limpiarCoords();
													}, false);
													
													
														var img = new Image();
														img.src = "@routes.Assets.at("images/tableros/real500.png")";
														img.onload = function(){
													        ctx.drawImage(img, 0, 0);
													     }	
													     
														canvas.addEventListener("click", function(evt) {
													
														var mousePos = oMousePos(canvas, evt);
														$.post("tablero",
															    {x:mousePos.x, y:mousePos.y},
															    function(data, textStatus, jqXHR)
														{
														var img = new Image();
														img.src = "@routes.Assets.at("images/tableros/real500.png")";
														img.onload = function(){

													        ctx.drawImage(img, 0, 0);
													     }	
															var ficha = new Image();
															ficha.src = "@routes.Assets.at("images/fichas/fAmarilla.png")";
															
															var split=data.split(";")
															
															ficha.onload = function(){ 
															
															ctx.drawImage(ficha,split[0],split[1]);
															document.getElementById("pr").innerHTML = split[2];
													    	document.getElementById("res1").value = split[3];
													    	document.getElementById("res2").value= split[4];
													    	document.getElementById("res3").value= split[5];
													    	document.getElementById("res4").value= split[6];
															document.getElementById("res").value = split[7];
															$("#acierto").hide();
															$("#error").hide();
															$("#ok").hide();
															$("#myModal").modal('show');
													    	   }
													      });		
												
												
														}, false); 
													
													    
												} 
								     
							
								}
					
								
								
						
					
							
							
						
						
						
								
								
									
					function marcarCoords(object, x, y){
							output.innerHTML = ("x: "+x+", y: "+y);
							output.style.top= (y+10)+"px";
							output.style.left= (x+10)+"px";
							output.style.backgroundColor="#FFF";
							output.style.border="1px solid #d9d9d9"
							canvas.style.cursor = "pointer";
					}
													
					function limpiarCoords(){
							output.innerHTML ="";
							output.style.top= 0+"px";
							output.style.left= 0+"px";
							output.style.backgroundColor="transparent"
							output.style.border="none";
							canvas.style.cursor = "default";
			}
									
					function oMousePos(canvas, evt) {
					var ClientRect = canvas.getBoundingClientRect();
							return {//objeto
							x: Math.round(evt.clientX - ClientRect.left),
							y: Math.round(evt.clientY - ClientRect.top)
							}
					}
			}
		</script>
			
	}
